<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Lab 0: Software Setup</title>
    <link rel="stylesheet" href="../labs.css" type="text/css">
</head>

<body>

<h1>Lab 0: Software Setup</h1>

<hr>

<h2>Overview</h2>
<p>
    In this lab, you will install and set up the software
    used in this course, including virtual machines, operating
    systems, compiler, debuggers, IDEs, among others.
    As some labs (e.g., network sniffing) is dangerous and may
    bring serious consequences, so you should finish these
    labs in virtual machines, do not finish them in your
    local machines.
</p>

<h3>Hand-in Procedure</h3>
<p>
    After finishing the assignment, you should zip your code
    files with the file
    name <samp>student ID-lab-&lt;n&gt;.zip</samp>
    (e.g., <samp>SA19225789-lab-0.zip</samp>)
    and submit it to the
    <a href="http://yjs.ustc.edu.cn/">Postgraduate Information Platform</a>.
</p>

<p>
    You do NOT need to submit anything for this lab.
</p>

<hr>
<h2>Part A: Installing Linux</h2>
<p>
    All experiments in this course must be completed with a
    Linux system, and we will use Ubuntu for our lab.
    In this part, you should install Linux first, if you have not.
</p>

<h3>1: Windows</h3>
<p>
    Please follow these steps to set up the Windows Subsystem
    for Linux (WSL):
</p>

<p>
    1. Create a new text file <samp>run.bat</samp> (Windows script file)
    at any location and paste
    the following content into it:
</p>
<div>
        <pre>
pushd "%~dp0"
dir /b %SystemRoot%\servicing\Packages\*Hyper-V*.mum > hyper-v.txt
for /f %%i in ('findstr /i . hyper-v.txt 2^>nul') do dism /online /norestart
/add-package:"%SystemRoot%\servicing\Packages\%%i"
del hyper-v.txt
Dism /online /enable-feature /featurename:Microsoft-Hyper-V -All /LimitAccess /ALL
pause
    </pre>
</div>
<p>
    Save the file then right-click, and run it with the administrator
    privilege. Then, reboot your computer.
</p>

<p>
    2. After your computer rebooted, open Windows Features
    (Press <code>Win+R</code> and enter <samp>optionalfeatures.exe</samp>):
    <br/><img src="imgs/lab0-1.png" alt="" width="400"><br/>

    Enable the following three options: Hyper-V, Windows Subsystem for Linux, and Virtual Machine Platform:
    <br/><img src="imgs/lab0-2.png" alt="" width="400">
    <br/><img src="imgs/lab0-3.png" alt="" width="400">
</p>

<p>
    3. Run PowerShell as an administrator, then run the command
    to update WSL:
<div>
    <kbd>
        $ wsl --update
    </kbd>
</div>
</p>

<p>
    4. If you want to learn more about WSL, please refer to the
    <a href="https://learn.microsoft.com/en-us/windows/wsl/">Microsoft Official Documentation</a>.
</p>


<h3>2: Mac (x86) or Linux</h3>
<ul>
    <li>
        Download and install <a href="https://multipass.run/install">
        Multipass</a>, then follow the instructions there to
        install the software.
    </li>
</ul>

<p>
    1. Install multipass using brew:
</p>
<pre>
        brew install --cask multipass
    </pre>

<p>
    2.Create and launch Ubuntu:
</p>
<pre>
        multipass launch --cpus 4 --disk 10G --mem 4G --name ubuntu
    </pre>

<p>3. View all images using multipass list: </p>
<pre>
       multipass list
    </pre>
<p>
    Note: Make a note of the 'Name' and 'IPv4' values displayed for Ubuntu. You'll need them to connect to the virtual
    machine using VSCode.
</p>
<p>4. Access Ubuntu: </p>
<pre>
       multipass shell ubuntu
    </pre>

<p>
    5. For accessing the container, you need to add the Mac's public key to the virtual machine first. On your Mac, use
    the following command to retrieve the public key:
</p>
<pre>
       cat .ssh/id_rsa.pub
    </pre>

<p>If it doesn't exist, create one using:</p>

<pre>
       ssh-keygen -t rsa
    </pre>

<p>
    Then, just press "Enter" for all the subsequent prompts. Afterwards, use the `cat` command to view the Mac's public
    key:
</p>
<pre>
       cat .ssh/id_rsa.pub
    </pre>

<p>Copy the output and paste it into the virtual machine's `.ssh/authorized_keys` file.</p>

<p>To remotely connect using VSCode, enter:</p>

<pre>
       ssh ubuntu@192.168.64.2 -A
    </pre>
After this, you can successfully connect and use it.
<br/>

<h3>3: Mac (M1/M2/M3)</h3>
<ul>
    <li>
        You may want to try <a href="https://mac.getutm.app/">
        UTM</a>.
    </li>
</ul>

<hr/>
<h2>Part B: Install Software</h2>
<h3>
    1.1 Install Ubuntu
</h3>

<p>
    To install Ubuntu in Windows WSL, open the WSL terminal
    and enter the command:
</p>
<div>
    <kbd>
        $ wsl --list --online <br/>
    </kbd>
</div>
which will list candidates OS images that you can install:

<br/> <img src="imgs/listonline.png" width="600" alt="">

<p>
    (2) We will be using Ubuntu-22.04 in this course, so
    enter the command following in the terminal:
</p>
<div>
    <kbd>
        $ wsl --install Ubuntu-22.04
    </kbd>
</div>
<p>
    (3) Set a name and password:
    <br/> <img src="imgs/Ubuntuhello.png" width="600" alt="">
</p>

<p>
    For Mac, run the
    <a href="https://multipass.run/install">Multipass commands</a>,
    to install Ubuntu-22.04:
</p>
<div>
    <kbd>
        $ multipass find
    </kbd>
</div>


<h3>
    1.2 Install GCC
</h3>
<p>
    GCC is a free compiler from the
    GNU project, and has been adopted as
    a standard
    compiler by most Unix-like operating systems
    (such as Linux, BSD, etc.). For more
    detailed information
    about GCC, you can refer to its
    <a href="https://gcc.gnu.org/onlinedocs/">official
        documentation</a>.
</p>
<p>
    (1) Enter the following command in the terminal,
    to install the GCC compiler:
</p>
<div>
    <kbd>
        $ apt-get install gcc
    </kbd>
</div>

<p>
    (2) Enter the command following in the terminal,
    to make sure the installation is successful:
</p>
<div>
    <kbd>
        $ gcc --version
    </kbd>
</div>

<b>Quick start</b>
<p>
    For the following
    <samp>hello.c</samp> program:
</p>
<pre>
    #include &lt;stdio.h&gt;
    void print(void){
        printf("hello, world!\n");
    }

    int main(){
        print();
        return 0;
    }
</pre>
<p>
    (2) Enter the command in the terminal:
</p>
<div>
    <kbd>
        $ gcc hello.c -o hello
    </kbd>
</div>
the source file can be compiled into an
executable file <samp>hello</samp>. Run the following
command:
<div>
    <kbd>
        $ ./hello
    </kbd>
</div>
to run the program.

<br/>
<h3>
    1.3 Install GDB
</h3>
<p>
    GDB is a debugger on
    UNIX and UNIX-like systems. By using GDB,
    you can debug your programs to inspect
    program and data such as variables, registers,
    and memory status.
    For more detailed information of GDB, you can refer to
    its <a href="https://www.gnu.org/software/gdb/documentation/">
    official documentation</a>.
</p>
<b>
    Install GDB
</b>
<p>
    (1) Run the following command to install
    the GDB debugging tool:
</p>
<div>
    <kbd>
        $ sudo apt-get install gdb
    </kbd>
</div>
<p>
    (2) To make sure your installation successful:
<div>
    <kbd>
        $ gdb --version
    </kbd>
</div>

<b>Quick start</b>
<p>
    To demonstrate the usage of gdb, let us debug the
    executable <samp>hello</samp> we just compiled with gcc:
</p>
<div>
    <kbd>
        $ gdb hello
    </kbd>
</div>
which will start the gdb.
<p>
    (3) Enter
</p>
<div>
    <kbd>
        $ break
    </kbd>
</div>
or the abbreviation
<div>
    <kbd>
        $ b
    </kbd>
</div>
in gdb, followed by an address,
to set up a break point. For example, we set up
a break point on the
<samp>print</samp> function:
<div>
    <kbd>
        $ break print
    </kbd>
</div>

<p>
    (4) Enter the command <samp>run</samp> to run the program in GDB.
    It can be found that the program execution is
    suspended at the breakpoint. As shown below:
</p>
<img src="imgs/image-20210921193009287.png" width="532" alt="">
<p>
    (5) Input the command <samp>continue</samp> or the
    abbreviation <samp>c</samp> to let the program
    continue to run. Enter the command <samp>quit</samp>
    to exit the GDB debugging interface.
</p>


<h3>1.4 make</h3>
<p>
    Make is a cross-platform building tool.
    For more detailed content of make, you can read
    its <a href="https://cmake.org/documentation/">
    official documentation</a>.
</p>
<b>
    Install make
</b>
<div>
    <kbd>
        $ apt install make
    </kbd>
</div>
and follow the prompts to install make. Make sure your
installation of make is successful:
<div>
    <kbd>
        $ make --version
    </kbd>
</div>

<h3>1.5 VSCode</h3>
<p>
    Visit the official website of <a href="https://code.visualstudio.com/">
    VSCode</a>,
    click Download for Windows
    <br/><img src="imgs/installvscode.png" width="691" alt="">
</p>

<b>Run VSCode</b>
<p>
    Enter the command following in the wsl terminal,
    you can open VSCode:
</p>

<div>
    <kbd>
        $ code .
    </kbd>
</div>
<br/><img src="imgs/code.png" width="691" alt="">

<h3>1.6 CLion</h3>
<p>
    CLion is a cross-platform IDE (Integrated
    development environment) designed for C/C++.
    It contains many
    intelligent functions, such as error prompts,
    code completion, automatic generation of make
    files, etc.,
    which greatly improves developer productivity.
</p>
<b>
    Install CLion
</b>
<p>
    Since CLion is a paid software, before the installation,we recommend you go to the <a
        href="https://account.jetbrains.com/login">official website of CLion</a> and use your USTC email to register
    an accountant. This will give you a one-year of CLion Professional Edition Eligibility for free use.
</p>


<br>
<hr>
This completes this lab. Remember to zip your
code with the file
name <samp>student ID-lab-&lt;N&gt;.zip</samp>
(e.g., <samp>SA19225789-lab-0.zip</samp>), and
submit it to the <a href="http://yjs.ustc.edu.cn/">
    Postgraduate Information Platform</a>.

<p>
    Happy hacking!
</p>

<br>
<br>


</body>

</html>